<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Django logging settings | Developer articles</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Django logging settings" />
<meta property="og:locale" content="en" />
<meta name="description" content="Gist Let’s look at default django logging settings and try to make them more useful. Here what we have in settings.py after command django-admin.py startproject project_name (django 1.5):" />
<meta property="og:description" content="Gist Let’s look at default django logging settings and try to make them more useful. Here what we have in settings.py after command django-admin.py startproject project_name (django 1.5):" />
<link rel="canonical" href="https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html" />
<meta property="og:url" content="https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html" />
<meta property="og:site_name" content="Developer articles" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-09-26T18:19:43+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Django logging settings" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2013-09-26T18:19:43+00:00","datePublished":"2013-09-26T18:19:43+00:00","description":"Gist Let’s look at default django logging settings and try to make them more useful. Here what we have in settings.py after command django-admin.py startproject project_name (django 1.5):","headline":"Django logging settings","mainEntityOfPage":{"@type":"WebPage","@id":"https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html"},"url":"https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" type="image/png" href="/favicon.png">
  <link rel="stylesheet" href="/en/assets/main.css">
  <link rel="stylesheet" href="/en/assets/css/styles.css"><link type="application/atom+xml" rel="alternate" href="https://st4lk.github.io/en/feed.xml" title="Developer articles" /><link type="application/atom+xml" rel="alternate" href="https://st4lk.github.io/en/feed.xml" title="Developer articles" /><script async defer src="https://buttons.github.io/buttons.js"></script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/en/">Developer Articles</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="/en/blog/">Blog</a>
          <a class="page-link" href="/en/about/">About</a>
          <a class="page-link" style="margin-right: 0px" href="/blog/2013/09/26/django-logging-settings.html" ><img src="/en/assets/images/ru.png" /></a>
          <a class="page-link" href="/en/blog/2013/09/26/django-logging-settings.html" ><img src="/en/assets/images/en.png" /></a>
          <a class="page-link" href="/en/search/" ><img src="/en/assets/images/search.svg" /></a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Django logging settings</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2013-09-26T18:19:43+00:00" itemprop="datePublished">Sep 26, 2013
      </time><span style="float:right">

  <span><a href="/en/category/django/index.html">django</a></span>
&nbsp;

  <span><a href="/en/category/logging/index.html">logging</a></span>


</span>
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div class="gist-wrp"><div class="github-btn" id="github-btn" style="float:right;"> <a class="gh-btn" id="gh-btn" href="https://gist.github.com/st4lk/6725777" target="_blank"> <span class="gh-ico"></span> <span class="gh-text" id="gh-text">Gist</span> </a></div></div>

<p>Let’s look at default django logging settings and try to make them more useful.</p>

<p>Here what we have in settings.py after command <code class="language-plaintext highlighter-rouge">django-admin.py startproject project_name</code> (django 1.5):</p>

<!--more-->

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># A sample logging configuration. The only tangible logging
# performed by this configuration is to send an email to
# the site admins on every HTTP 500 error when DEBUG=False.
# See http://docs.djangoproject.com/en/dev/topics/logging for
# more details on how to customize your logging configuration.
</span><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">'disable_existing_loggers'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s">'filters'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'require_debug_false'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'()'</span><span class="p">:</span> <span class="s">'django.utils.log.RequireDebugFalse'</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">'handlers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'mail_admins'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'ERROR'</span><span class="p">,</span>
            <span class="s">'filters'</span><span class="p">:</span> <span class="p">[</span><span class="s">'require_debug_false'</span><span class="p">],</span>
            <span class="s">'class'</span><span class="p">:</span> <span class="s">'django.utils.log.AdminEmailHandler'</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">'loggers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'django.request'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'handlers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'mail_admins'</span><span class="p">],</span>
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'ERROR'</span><span class="p">,</span>
            <span class="s">'propagate'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>As it written in comments, logger ‘django.request’ will sent email message to admins on every HTTP 500 error (they are in fact uncaught exceptions) when DEBUG=False. Email list is set in <code class="language-plaintext highlighter-rouge">settings.ADMINS</code>.</p>

<p>But, that’s not all. There are also default settings, they are set in <code class="language-plaintext highlighter-rouge">django.utils.log.DEFAULT_LOGGING</code>. Here how they look like for version 1.5.4 (actual version can be found on <a href="https://github.com/django/django/blob/master/django/utils/log.py">github</a>):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DEFAULT_LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">'disable_existing_loggers'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s">'filters'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'require_debug_false'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'()'</span><span class="p">:</span> <span class="s">'django.utils.log.RequireDebugFalse'</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">'require_debug_true'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'()'</span><span class="p">:</span> <span class="s">'django.utils.log.RequireDebugTrue'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s">'handlers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'console'</span><span class="p">:{</span>
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'INFO'</span><span class="p">,</span>
            <span class="s">'filters'</span><span class="p">:</span> <span class="p">[</span><span class="s">'require_debug_true'</span><span class="p">],</span>
            <span class="s">'class'</span><span class="p">:</span> <span class="s">'logging.StreamHandler'</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">'null'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'class'</span><span class="p">:</span> <span class="s">'django.utils.log.NullHandler'</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">'mail_admins'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'ERROR'</span><span class="p">,</span>
            <span class="s">'filters'</span><span class="p">:</span> <span class="p">[</span><span class="s">'require_debug_false'</span><span class="p">],</span>
            <span class="s">'class'</span><span class="p">:</span> <span class="s">'django.utils.log.AdminEmailHandler'</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s">'loggers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'django'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'handlers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'console'</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="s">'django.request'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'handlers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'mail_admins'</span><span class="p">],</span>
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'ERROR'</span><span class="p">,</span>
            <span class="s">'propagate'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">'py.warnings'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'handlers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'console'</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="what-do-they-mean">What do they mean?</h3>

<p>Logger ‘django’ writes all logs from child loggers to console with message level WARNING and higher (‘level’ for logger ‘django’ is not set, by default it is WARNING). Child loggers are: ‘django.db.backends’, ‘django.contrib.gis’ and so on. But except ‘django.request’ which has ‘propagate’: False.</p>

<p>Logger ‘py.warnings’ also writes messages from module <a href="http://docs.python.org/2/library/warnings.html">warnings</a> into console. For example DeprecationWarnings.</p>

<h3 id="example-of-useful-to-my-mind-config">Example of useful (to my mind) config</h3>

<p>For simplicity only one root logger can be defined, that will catch logs from all modules. If <code class="language-plaintext highlighter-rouge">settings.DEBUG = True</code> it will write messages to console and into special debug log-file. And if <code class="language-plaintext highlighter-rouge">settings.DEBUG = False</code>, messages will be written only in production log-file, with level INFO and higher only.</p>

<p>When <code class="language-plaintext highlighter-rouge">settings.DEBUG = True</code> all SQL queries will be written in console and in debug log-file, that is very useful. If you wish, it is possible to define separate logger ‘django.db’ with ‘propagate’: False and set to it needed settings.</p>

<p>As i define root logger, other loggers will have empty handlers list, to not duplicate messages.</p>

<p>Source at <a href="https://gist.github.com/st4lk/6725777">gist.github</a></p>

<script src="https://gist.github.com/st4lk/6725777.js"></script>

<h4 id="settings-will-work-with-django-15">Settings will work with django 1.5+</h4>

<p>For earlier django version it is probably needed co create file log.py somewhere:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>


<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">NullHandler</span>
<span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">NullHandler</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Handler</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
            <span class="k">pass</span>


<span class="k">class</span> <span class="nc">RequireDebugTrue</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Filter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">settings</span><span class="p">.</span><span class="n">DEBUG</span>


<span class="k">class</span> <span class="nc">RequireDebugFalse</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Filter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">settings</span><span class="p">.</span><span class="n">DEBUG</span>
</code></pre></div></div>

<p>And use path to this file for <code class="language-plaintext highlighter-rouge">NullHandler</code>, <code class="language-plaintext highlighter-rouge">RequireDebugTrue</code>, <code class="language-plaintext highlighter-rouge">RequireDebugFalse</code> instead of <code class="language-plaintext highlighter-rouge">django.utils.log. ...</code>.</p>

<p>Now you can do in any source file:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">logger</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="s">"some message"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"oops, it is a warning"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="s">"bad, very bad"</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># do something
</span><span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
    <span class="n">logger</span><span class="p">.</span><span class="n">exception</span><span class="p">(</span><span class="s">"I know it could happen"</span><span class="p">)</span>
</code></pre></div></div>

<p>and all your logs will be processed, depending on DEBUG.</p>

  </div>

  <div class="post-categories">

  <span><a href="/en/category/django/index.html">django</a></span>
&nbsp;

  <span><a href="/en/category/logging/index.html">logging</a></span>


</div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html';
      this.page.identifier = 'https://st4lk.github.io/en/blog/2013/09/26/django-logging-settings.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://lexev-dev.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/en/blog/2013/09/26/django-logging-settings.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/en/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Developer articles</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Developer articles</li><li><a class="u-email" href="mailto:alexevseev@gmail.com">alexevseev@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/st4lk"><svg class="svg-icon"><use xlink:href="/en/assets/minima-social-icons.svg#github"></use></svg> <span class="username">st4lk</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
<script id="dsq-count-scr" src="//lexev-dev.disqus.com/count.js" async></script></body>

</html>
