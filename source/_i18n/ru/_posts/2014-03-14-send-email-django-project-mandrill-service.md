---
layout: post
title:  "Отправка писем в django проекте с помощью сервиса mandrill"
date:   2014-03-14 18:19:43 +0000
categories: api django email free
redirect_from:
  - /2014/send-email-django-project-mandrill-service/
---

[![Отправка писем в django проекте с помощью сервиса mandrill](/assets/images/posts/2014-03-14-send-email-django-project-mandrill-service/mandrill-email.png "Отправка писем в django проекте с помощью сервиса mandrill")]({{ site.baseurl }}{{ page.url }})

Отправлять email сообщения с сервера можно просто по SMTP протоколу. Но есть другой способ - через специальные сервисы рассылки. Про один такой, [mandrill.com](http://mandrill.com/), я немного расскажу.

<!--more-->

### Преимущества относительно SMTP

- Подробная статистика отправленных писем. Сколько писем отправлено, кому, когда. Сколько писем открыли, какие ссылки нажимали.
- Шаблоны писем. Их можно редактировать через сервис mandrill, т.о. образом не нужно ничего придумывать в админке django. В шаблоне можно использовать переменные, задавать тему письма, даже адрес отправителя. Из django вы просто указываете, какой шаблон использовать и передаете нужные переменные.
- Не нужен свой почтовый сервис. И не обязательно подключать свой домен к яндекс/гугл почте (но все же лишним не будет, это удобно).
- Есть бесплатный тариф, который позволяет отправить 12000 писем в месяц.

### Недостатки

- Для подсчета статистики все ссылки в вашем письме будут заменены на специальные редиректы. Обычный пользователь скорее всего ничего не заметит.
- В некоторых почтовых клиентах (например gmail в браузере) в поле адресат вместе с указанным вами адресом-отправителем будет так же указан истинный адрес mandrill. Однако можно настроить DNS записи DKIM и SPF для вашего домена, тогда адрес отправителя будет отображаться корректно везде.
- Если нужно отправить больше 12000 писем в месяц - нужно купить соответствующий тариф.

По-моему, преимущества превышают недостатки.

### Подключаем

1. Регистриуемся [https://mandrill.com/signup/](https://mandrill.com/signup/)

2. Создаем API_KEY:

[![Создаем API_KEY шаг 1](http://img-fotki.yandex.ru/get/9745/85893628.0/0_f6844_ecbf9fca_L.png
 "Создаем API_KEY шаг 1")](http://img-fotki.yandex.ru/get/9745/85893628.0/0_f6844_ecbf9fca_orig.png)

[![Создаем API_KEY шаг 2](http://img-fotki.yandex.ru/get/9805/85893628.0/0_f6845_733b2009_L.png
 "Создаем API_KEY шаг 2")](http://img-fotki.yandex.ru/get/9805/85893628.0/0_f6845_733b2009_orig.png)

[![Создаем API_KEY шаг 3](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6846_f8612a87_L.png
 "Создаем API_KEY шаг 3")](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6846_f8612a87_orig.png)<br/><br/><br/>
3. Создаем шаблон для письма:

[![Создаем шаблон для письма шаг 1](http://img-fotki.yandex.ru/get/9805/85893628.0/0_f6847_faf2f86c_L.png
 "Создаем шаблон для письма шаг 1")](http://img-fotki.yandex.ru/get/9805/85893628.0/0_f6847_faf2f86c_orig.png)

[![Создаем шаблон для письма шаг 2](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6848_d4286972_L.png
 "Создаем шаблон для письма шаг 2")](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6848_d4286972_orig.png)<br/><br/>
3.1. Вводим имя шаблона (например template-1):

[![Вводим имя шаблона](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6849_c232d9f3_L.png
 "Вводим имя шаблона")](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f6849_c232d9f3_orig.png)<br/><br/><br/>
4. Создаем шаблон письма:

[![Создаем шаблон письма](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f684a_b8b66799_L.png
 "Создаем шаблон письма")](http://img-fotki.yandex.ru/get/9745/85893628.1/0_f684a_b8b66799_orig.png)


### Как выглядит статистика

1. График отправления по времени:

[![График отправления по времени](http://img-fotki.yandex.ru/get/9799/85893628.1/0_f684e_2538ff4a_L.png
 "График отправления по времени")](http://img-fotki.yandex.ru/get/9799/85893628.1/0_f684e_2538ff4a_orig.png)<br/><br/><br/>
2. График открытия писем и кликов по ссылкам:

[![График открытия писем и кликов по ссылкам](http://img-fotki.yandex.ru/get/9764/85893628.1/0_f684f_c33c7bb1_L.png
 "График открытия писем и кликов по ссылкам")](http://img-fotki.yandex.ru/get/9764/85893628.1/0_f684f_c33c7bb1_orig.png)<br/><br/><br/>
3. Список всех отправленных писем:

[![Список всех отправленных писем](http://img-fotki.yandex.ru/get/9828/85893628.1/0_f6850_89340ff9_L.png
 "Список всех отправленных писем")](http://img-fotki.yandex.ru/get/9828/85893628.1/0_f6850_89340ff9_orig.png)<br/><br/><br/>
4. Статистика кликов по каждой ссылке:

[![Статистика кликов по каждой ссылке](http://img-fotki.yandex.ru/get/9764/85893628.1/0_f6851_de5ee46e_L.png
 "Статистика кликов по каждой ссылке")](http://img-fotki.yandex.ru/get/9764/85893628.1/0_f6851_de5ee46e_orig.png)<br/><br/><br/>

### Интеграция с django

В [gist'e](https://gist.github.com/st4lk/9877661) приведены примеры интеграции с django, а также использования просто из python скрипта.

<script src="https://gist.github.com/st4lk/9877661.js"></script>
